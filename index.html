<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>IT Dashboard</title>
<style>
body{margin:0;font-family:sans-serif;background:#f4f6f9}
.sidebar{width:260px;background:#1f2937;color:#fff;height:100vh;position:fixed;padding:20px}
.main{margin-left:260px;padding:20px}
table{width:100%;background:#fff;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #ddd}
th{background:#e5e7eb}
button{padding:6px 10px;border:none;border-radius:5px;cursor:pointer}
</style>
</head>
<body>

<div class="sidebar">
  <h3>‚õë IT UDH Maintenance</h3>
  <p id="userInfo"></p>
</div>

<div class="main">
<h2>üìã ‡∏á‡∏≤‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</h2>
<table>
<thead>
<tr><th>Job</th><th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th><th>‡∏õ‡∏±‡∏ç‡∏´‡∏≤</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr>
</thead>
<tbody id="jobs"></tbody>
</table>
</div>

<script>
const user = JSON.parse(sessionStorage.getItem('user'));
document.getElementById('userInfo').innerHTML =
  `${user.name}<br>${user.position}<br>${user.department}`;

google.script.run.withSuccessHandler(render).getJobs();

function render(data){
  const tb=document.getElementById('jobs');
  tb.innerHTML='';
  data.forEach(j=>{
    tb.innerHTML+=`
    <tr>
      <td>${j.jobId}</td>
      <td>${j.department}</td>
      <td>${j.detail}</td>
      <td>${j.status}</td>
      <td>
        <button onclick="update('${j.jobId}','IN PROGRESS')">‡∏£‡∏±‡∏ö</button>
        <button onclick="update('${j.jobId}','CLOSE')">‡∏õ‡∏¥‡∏î</button>
      </td>
    </tr>`;
  });
}

function update(id,status){
  google.script.run.withSuccessHandler(()=>location.reload())
    .updateJob(id,status,user.name);
}
</script>

</body>
</html>
