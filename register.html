<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô IT - ‡∏£‡∏û.‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ</title>
    <link rel="stylesheet" href="style.css?v=1.1">
</head>
<body>
    <div id="loader" class="loader-overlay" style="display:none;"><div class="spinner"></div></div>

    <div class="login-wrapper">
        <div class="login-header">
            <img src="https://img2.pic.in.th/-227e4f6f84f29f020.png" class="header-logo">
            <h2>‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ</h2>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà IT</p>
        </div>

        <div class="login-card">
            <h3 style="margin-bottom: 20px; color: #ff0080; border-bottom: 2px solid #fce4ec; padding-bottom: 10px;">üìã ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
            
            <div class="form-group">
                <label>üÜî USERID (‡πÑ‡∏≠‡∏î‡∏µ)</label>
                <input type="text" id="USERID" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏≠‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£">
            </div>

            <div class="form-group">
                <label>üìß UserMail (‡∏≠‡∏µ‡πÄ‡∏°‡∏•)</label>
                <input type="email" id="UserMail" placeholder="‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏°‡∏•">
            </div>

            <div class="form-group">
                <label>üë§ UserName (‡∏ä‡∏∑‡πà‡∏≠)</label>
                <input type="text" id="UserName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á">
            </div>

            <div class="form-group">
                <label>üë• UserSname (‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•)</label>
                <input type="text" id="UserSname" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
            </div>

            <div class="form-group">
                <label>üíº UserTypeName (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á)</label>
                <select id="UserTypeName">
                    <option value="‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå">‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                    <option value="‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå">‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                    <option value="‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô IT">‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô IT</option>
                </select>
            </div>

            <button onclick="handleRegister()" class="btn-login" id="submitBtn">üì© ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏≤‡∏á‡πÄ‡∏°‡∏•</button>
            
            <button onclick="window.location.replace('login.html')" class="btn-back">‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login</button>
        </div>
    </div>

    <script src="js/main.js"></script> 
    <script>
       async function handleRegister() {
    const data = {
        action: 'registerIT',
        USERID: document.getElementById('USERID').value,
        UserMail: document.getElementById('UserMail').value,
        UserName: document.getElementById('UserName').value,
        UserSname: document.getElementById('UserSname').value,
        UserTypeName: document.getElementById('UserTypeName').value
    };

    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzNSgpYNigJX7W-RUPq8SLN4e687pE55p72KsbM-nWFcPefKDhjzYAflsm78i42IW7qrw/exec"; 

    try {
        const response = await fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify(data)
        });
        const res = await response.json();
        if(res.success) {
            alert("‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á ITUser ‡πÅ‡∏•‡πâ‡∏ß");
            window.location.replace('login.html');
        }
    } catch (error) {
        alert("‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á Deploy ‡πÄ‡∏õ‡πá‡∏ô Anyone ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
    }
}
    </script>
</body>
</html>
