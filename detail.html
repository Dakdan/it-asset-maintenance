<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:Kanit,sans-serif;
  background:#fff0f5;
  margin:0;
}
header{
  background:#ffb6c1;
  border-bottom:3px solid #000;
  padding:10px;
  display:flex;
  gap:15px;
  align-items:center;
}
header img{ height:50px; }

.card{
  background:#fff;
  border:2px solid #000;
  border-radius:16px;
  padding:20px;
  margin:20px;
}

table{
  width:100%;
  border-collapse:collapse;
}
td{
  border:1px solid #000;
  padding:6px;
}

img.asset{
  max-width:100%;
  border-radius:12px;
  margin-bottom:10px;
}
</style>
</head>

<body>

<header>
<img src="https://img2.pic.in.th/pic/ink.png">
<div>
<b>‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ</b><br>
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô:‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå
</div>
</header>

<div class="card">
<h3 id="title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</h3>

<img id="assetImg" class="asset" style="display:none">

<table id="detailTable"></table>

<button onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
<button onclick="history.back()">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<script>
const API="https://script.google.com/macros/s/AKfycbwj8TX_Lwv_oRLd3CtFL7ORBSu4CyweKfdoxF5vi-7UBqPeml6EBNmCCLDJ7qmsKqjD/exec";
const id = new URLSearchParams(location.search).get("id");

if(!id){
  document.body.innerHTML="‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå";
}

fetch(API+"?action=detail&id="+id)
.then(r=>r.json())
.then(d=>{
  if(!d){
    detailTable.innerHTML="<tr><td>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>";
    return;
  }

  title.innerText = "‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå : " + d[2];

  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏π‡∏õ (Ass_Img)
  if(d[20]){
    assetImg.src = "https://drive.google.com/uc?id=" + d[20];
    assetImg.style.display="block";
  }

  const rows = [
    ["‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå", d[5]],
    ["Serial", d[3]],
    ["‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", d[8]],
    ["‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô", d[11]],
    ["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠", d[15]],
    ["‡∏£‡∏≤‡∏Ñ‡∏≤", d[16]],
    ["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", d[19]]
  ];

  detailTable.innerHTML = rows.map(r=>`
    <tr>
      <td><b>${r[0]}</b></td>
      <td>${r[1]||"-"}</td>
    </tr>
  `).join("");
});
</script>

</body>
</html>
