<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Dashboard р╕кр╕│р╕гр╕зр╕Ир╕Др╕гр╕╕р╕ар╕▒р╕Ур╕Ср╣М</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-light p-4">

<h4 class="mb-4">ЁЯУК Dashboard р╕Бр╕▓р╕гр╕кр╕│р╕гр╕зр╕Ир╕Др╕гр╕╕р╕ар╕▒р╕Ур╕Ср╣М</h4>

<table class="table table-bordered bg-white shadow">
<thead class="table-dark">
<tr>
  <th>р╕лр╕Щр╣Ир╕зр╕вр╕Зр╕▓р╕Щ</th>
  <th>р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕г</th>
  <th>р╕кр╕Цр╕▓р╕Щр╕░</th>
</tr>
</thead>
<tbody id="tb"></tbody>
</table>

<script>
const API="https://script.google.com/macros/s/AKfycbwj8TX_Lwv_oRLd3CtFL7ORBSu4CyweKfdoxF5vi-7UBqPeml6EBNmCCLDJ7qmsKqjD/exec";

function api(p,cb){
  const c="cb"+Date.now(); p.callback=c;
  window[c]=(r)=>{delete window[c];document.body.removeChild(s);cb(r);}
  const s=document.createElement("script");
  s.src=API+"?"+new URLSearchParams(p);
  document.body.appendChild(s);
}

api({action:"adminDashboard"},res=>{
  const tb=document.getElementById("tb");
  res.data.forEach(r=>{
    tb.innerHTML+=`
      <tr>
        <td>${r.deptName}</td>
        <td class="text-center">${r.count}</td>
        <td class="text-center">
          <span class="badge ${r.status=="р╕кр╣Ир╕Зр╣Бр╕ер╣Йр╕з"?"bg-success":"bg-danger"}">
            ${r.status}
          </span>
        </td>
      </tr>`;
  });
});
</script>
</body>
</html>
