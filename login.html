<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>IT Login</title>
<link rel="stylesheet" href="style.css">
<style>
.wrap{max-width:420px;margin:80px auto}
input,select,button{
 width:100%;padding:12px;margin-top:10px;
 border-radius:12px;border:2px solid #ff4fb3;
 font-size:15px
}
button{background:#ff1b8d;color:#fff;font-weight:bold}
.hide{display:none}
.link{text-align:center;margin-top:12px}
</style>
</head>

<body>
<div class="wrap card">

<h2 id="title">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>

<!-- LOGIN -->
<div id="loginBox">
 <input id="l_user" placeholder="Username">
 <input id="l_pass" type="password" placeholder="Password">
 <button onclick="login()">Login</button>
 <div class="link">
  ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ?
  <a href="#" onclick="showRegister()">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>
 </div>
</div>

<!-- REGISTER -->
<div id="registerBox" class="hide">
 <input id="r_fname" placeholder="‡∏ä‡∏∑‡πà‡∏≠">
 <input id="r_lname" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
 <input id="r_email" placeholder="Email">
 <input id="r_user" placeholder="‡∏ï‡∏±‡πâ‡∏á Username">
 <input id="r_pass" type="password" placeholder="‡∏ï‡∏±‡πâ‡∏á Password">

 <button onclick="register()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>

 <div class="link">
  <a href="#" onclick="showLogin()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</a>
 </div>
</div>

<p id="msg" style="color:red;text-align:center"></p>

</div>

<script src="js/api.js"></script>
<script>
const loginBox=document.getElementById("loginBox");
const registerBox=document.getElementById("registerBox");
const title=document.getElementById("title");
const msg=document.getElementById("msg");

function showRegister(){
 title.innerText="üìã ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô";
 loginBox.classList.add("hide");
 registerBox.classList.remove("hide");
 msg.innerText="";
}

function showLogin(){
 title.innerText="üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
 registerBox.classList.add("hide");
 loginBox.classList.remove("hide");
 msg.innerText="";
}

/* LOGIN */
function login(){
 apiPost({
  action:"login",
  user:l_user.value,
  pass:l_pass.value
 }).then(r=>{
  if(r.success){
   localStorage.setItem("it_token",r.token);
   location.href="index.html";
  }else{
   msg.innerText="‚ùå Username ‡∏´‡∏£‡∏∑‡∏≠ Password ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
  }
 });
}

/* REGISTER */
function register(){
 apiPost({
  action:"register",
  fname:r_fname.value,
  lname:r_lname.value,
  email:r_email.value,
  user:r_user.value,
  pass:r_pass.value,
  dept:r_dept.value
 }).then(r=>{
  if(r.success){
   alert("‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
   showLogin();
  }else{
   msg.innerText=r.message||"‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
  }
 });
}
</script>
</body>
</html>
